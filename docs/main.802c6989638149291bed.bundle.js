webpackJsonp([1],{0:function(n,t,l){n.exports=l("cDNt")},cDNt:function(n,t,l){"use strict";function e(n){return p._24(0,[(n()(),p._8(0,0,null,null,4,"li",[],null,null,null,null,null)),(n()(),p._23(-1,null,["\n      "])),(n()(),p._8(2,0,null,null,1,"span",[["class","sample"]],null,null,null,null,null)),(n()(),p._23(3,null,["",""])),(n()(),p._23(4,null,[" [","]\n    "]))],null,function(n,t){n(t,3,0,t.context.$implicit.letter),n(t,4,0,t.context.$implicit.count)})}function r(n){return p._24(0,[p._21(402653184,1,{canvasRef:0}),(n()(),p._8(1,0,null,null,13,"div",[["class","canvasHolder"]],null,[["window","resize"]],function(n,t,l){var e=!0,r=n.component;if("window:resize"===t){e=!1!==r.fitToContainer()&&e}return e},null,null)),(n()(),p._23(-1,null,["\n  "])),(n()(),p._8(3,0,null,null,7,"div",[["class","topHint"]],null,null,null,null,null)),(n()(),p._23(-1,null,["\n    "])),(n()(),p._8(5,0,null,null,1,"span",[],null,null,null,null,null)),(n()(),p._23(-1,null,["Draw a char here"])),(n()(),p._23(-1,null,["\n    "])),(n()(),p._8(8,0,null,null,1,"span",[["class","clear"]],null,[[null,"click"]],function(n,t,l){var e=!0,r=n.component;if("click"===t){e=!1!==r.onClear()&&e}return e},null,null)),(n()(),p._23(-1,null,["[ clear ]"])),(n()(),p._23(-1,null,["\n  "])),(n()(),p._23(-1,null,["\n  "])),(n()(),p._8(12,0,[[1,0],["canvas",1]],null,1,"canvas",[],null,[[null,"mousedown"],[null,"touchstart"],[null,"touchend"],[null,"mouseup"],[null,"mousemove"],[null,"touchmove"]],function(n,t,l){var e=!0,r=n.component;if("mousedown"===t){e=!1!==r.onDown()&&e}if("touchstart"===t){e=!1!==r.onDown()&&e}if("touchend"===t){e=!1!==r.onUp()&&e}if("mouseup"===t){e=!1!==r.onUp()&&e}if("mousemove"===t){e=!1!==r.onMove(l)&&e}if("touchmove"===t){e=!1!==r.onTouchMove(l)&&e}return e},null,null)),(n()(),p._23(-1,null,["\n  "])),(n()(),p._23(-1,null,["\n"])),(n()(),p._23(-1,null,["\n"])),(n()(),p._8(16,0,null,null,19,"div",[["class","samplesHolder"]],null,null,null,null,null)),(n()(),p._23(-1,null,["\n  "])),(n()(),p._8(18,0,null,null,1,"span",[],null,null,null,null,null)),(n()(),p._23(-1,null,["Add it to the learn list"])),(n()(),p._23(-1,null,["\n  "])),(n()(),p._8(21,0,null,null,0,"br",[],null,null,null,null,null)),(n()(),p._23(-1,null,["\n  "])),(n()(),p._8(23,0,null,null,0,"br",[],null,null,null,null,null)),(n()(),p._23(-1,null,[" \n  "])),(n()(),p._8(25,0,[["letter",1]],null,0,"input",[],null,null,null,null,null)),(n()(),p._23(-1,null,["\n  "])),(n()(),p._8(27,0,null,null,1,"button",[],null,[[null,"click"]],function(n,t,l){var e=!0,r=n.component;if("click"===t){r.addSample(p._20(n,25).value);e=!1!==(p._20(n,25).value="")&&e}return e},null,null)),(n()(),p._23(-1,null,["Add"])),(n()(),p._23(-1,null,["\n  "])),(n()(),p._8(30,0,null,null,4,"ul",[["class","samples"]],null,null,null,null,null)),(n()(),p._23(-1,null,["\n    "])),(n()(),p._2(16777216,null,null,1,null,e)),p._6(33,802816,null,0,M.c,[p.Q,p.N,p.t],{ngForOf:[0,"ngForOf"]},null),(n()(),p._23(-1,null,["\n  "])),(n()(),p._23(-1,null,["\n"])),(n()(),p._23(-1,null,["\n"])),(n()(),p._8(37,0,null,null,0,"div",[["class","separator"]],null,null,null,null,null)),(n()(),p._23(-1,null,["\n"]))],function(n,t){n(t,33,0,t.component.sampleGroups)},null)}function u(n){return p._24(0,[(n()(),p._8(0,0,null,null,1,"app-drawing",[],null,null,null,r,P)),p._6(1,114688,null,0,b,[v,C],null,null)],function(n,t){n(t,1,0)},null)}function i(n){return p._24(0,[(n()(),p._8(0,0,null,null,1,"span",[["class","control"]],null,[[null,"click"]],function(n,t,l){var e=!0,r=n.component;if("click"===t){e=!1!==r.create()&&e}return e},null,null)),(n()(),p._23(-1,null,["\n\t  [ train ]\n\t"]))],null,null)}function o(n){return p._24(0,[(n()(),p._8(0,0,null,null,1,"span",[["class","control"]],null,[[null,"click"]],function(n,t,l){var e=!0,r=n.component;if("click"===t){e=!1!==r.create()&&e}return e},null,null)),(n()(),p._23(-1,null,["\n\t  [ stop ]\n\t"]))],null,null)}function s(n){return p._24(0,[(n()(),p._8(0,0,null,null,10,"div",[["class","netConrols"]],null,null,null,null,null)),(n()(),p._23(-1,null,["\n\t"])),(n()(),p._2(16777216,null,null,1,null,i)),p._6(3,16384,null,0,M.d,[p.Q,p.N],{ngIf:[0,"ngIf"]},null),(n()(),p._23(-1,null,["\n\t"])),(n()(),p._2(16777216,null,null,1,null,o)),p._6(6,16384,null,0,M.d,[p.Q,p.N],{ngIf:[0,"ngIf"]},null),(n()(),p._23(-1,null,["\n\t\t\xa0\xa0\xa0\n    "])),(n()(),p._8(8,0,null,null,1,"span",[["class","control"]],null,[[null,"click"]],function(n,t,l){var e=!0,r=n.component;if("click"===t){e=!1!==r.check()&&e}return e},null,null)),(n()(),p._23(-1,null,["\n\t  [ check ]\n\t"])),(n()(),p._23(-1,null,["\n"])),(n()(),p._23(-1,null,["\n"])),(n()(),p._8(12,0,null,null,10,"div",[["class","trainInfo netConrols"]],null,null,null,null,null)),(n()(),p._23(-1,null,["\n\t"])),(n()(),p._8(14,0,null,null,1,"div",[],null,null,null,null,null)),(n()(),p._23(15,null,["MSE Initial: ",""])),(n()(),p._23(-1,null,["\n\t"])),(n()(),p._8(17,0,null,null,1,"div",[],null,null,null,null,null)),(n()(),p._23(18,null,["MSE Current: ",""])),(n()(),p._23(-1,null,["\n\t"])),(n()(),p._8(20,0,null,null,1,"div",[],null,null,null,null,null)),(n()(),p._23(21,null,["Iterations: ",""])),(n()(),p._23(-1,null,["\n"])),(n()(),p._23(-1,null,["\n\n\n"]))],function(n,t){var l=t.component;n(t,3,0,!l.trainingStarted),n(t,6,0,l.trainingStarted)},function(n,t){var l=t.component;n(t,15,0,l.errInital),n(t,18,0,l.errCurrent),n(t,21,0,l.iterations)})}function a(n){return p._24(0,[(n()(),p._8(0,0,null,null,1,"app-training",[],null,null,null,s,D)),p._6(1,114688,null,0,k,[C],null,null)],function(n,t){n(t,1,0)},null)}function c(n){return p._24(0,[(n()(),p._23(-1,null,["\n"])),(n()(),p._8(1,0,null,null,4,"div",[["style","text-align:center"]],null,null,null,null,null)),(n()(),p._23(-1,null,["\n  "])),(n()(),p._8(3,0,null,null,1,"h1",[],null,null,null,null,null)),(n()(),p._23(-1,null,["\n    Neural Hand Writing Recognizer \n  "])),(n()(),p._23(-1,null,["\n"])),(n()(),p._23(-1,null,["\n"])),(n()(),p._8(7,0,null,null,1,"app-drawing",[],null,null,null,r,P)),p._6(8,114688,null,0,b,[v,C],null,null),(n()(),p._23(-1,null,["\n"])),(n()(),p._8(10,0,null,null,1,"app-training",[],null,null,null,s,D)),p._6(11,114688,null,0,k,[C],null,null),(n()(),p._23(-1,null,["\n"]))],function(n,t){n(t,8,0),n(t,11,0)},null)}function h(n){return p._24(0,[(n()(),p._8(0,0,null,null,1,"app-root",[],null,null,null,c,W)),p._6(1,49152,null,0,g,[],null,null)],null,null)}Object.defineProperty(t,"__esModule",{value:!0});var p=l("/oeL"),f={production:!0},_=function(){function n(){}return n}(),g=function(){function n(){}return n}(),d=[""],m=[".canvasHolder[_ngcontent-%COMP%]{width:40%;height:18em;margin-left:5%;margin-right:2%;float:left;min-width:240px;margin-bottom:3.4em}.canvasHolder[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{width:100%;height:100%;background-color:#d3d3d3;cursor:crosshair;border-radius:4px;border:1px solid #000}.samplesHolder[_ngcontent-%COMP%]{width:40%;margin-left:2%;margin-right:5%;height:50%;float:left;min-width:280px}.clear[_ngcontent-%COMP%]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;font-weight:700;float:right}.clear[_ngcontent-%COMP%]:hover{color:#607d8b}.samples[_ngcontent-%COMP%]{margin:0 0 2em 0;list-style-type:none;padding:0;width:15em}.samples[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{cursor:pointer;position:relative;left:0;background-color:#eee;margin:.2em;padding:.2em 0;border-radius:4px}.samples[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{color:#607d8b;background-color:#ddd}.samples[_ngcontent-%COMP%]   .sample[_ngcontent-%COMP%]{padding-left:2em;font-weight:700}input[_ngcontent-%COMP%]{margin:.4em;width:8.5em}button[_ngcontent-%COMP%], input[_ngcontent-%COMP%]{font-size:120%}"],v=function(){function n(){this.points=[],this.samples=[],this.sampleGroups=[],this.letterIndex=[],this.sensorWidth=12,this.sensorHeihht=12}return n.prototype.addSample=function(n){if(console.log("add sample 1"),console.log(this.letterIndex[n.letter]),void 0===this.letterIndex[n.letter]){var t={letter:n.letter,count:0};this.letterIndex[n.letter]=t,this.sampleGroups.push(t),console.log(this.sampleGroups),n.points.length>0&&(t.count++,this.samples.push(n))}else n.points.length>0&&(this.letterIndex[n.letter].count++,this.samples.push(n))},n.prototype.outputFromSample=function(n){for(var t=[],l=0;l<this.sampleGroups.length;l++)this.sampleGroups[l].letter===n.letter?t.push(1):t.push(0);return t},n.prototype.gridFromSample=function(n){for(var t=-1/0,l=-1/0,e=1/0,r=1/0,u=0,i=n.points;u<i.length;u++){var o=i[u];o.x>t&&(t=o.x),o.x<e&&(e=o.x),o.y>l&&(l=o.y),o.y<r&&(r=o.y)}console.log(e+" "+r+" "+t+" "+l);var s=new Array(this.sensorWidth*this.sensorHeihht);s.fill(0);for(var a=0,c=n.points;a<c.length;a++){var o=c[a],h=this.sensorWidth*(o.x-e)/(t-e+1),p=this.sensorHeihht*(o.y-r)/(l-r+1);s[Math.floor(h)+this.sensorWidth*Math.floor(p)]=1,console.log(Math.floor(h)+" "+Math.floor(p))}for(var f="",_=0;_<s.length;_++)_%this.sensorWidth==0&&(f+="\n"),f+=s[_];return console.log(f),s},n.prototype.getTrainData=function(){for(var n=[],t=0,l=this.samples;t<l.length;t++){var e=l[t];n.push({inputs:this.gridFromSample(e),outputs:this.outputFromSample(e)})}return n},n.ctorParameters=function(){return[]},n}(),y=function(){function n(n){this.error=0,this.weights=new Array,this.deltas=new Array;for(var t=0;t<n;t++)this.weights.push(.1*Math.random()),this.deltas.push(0)}return n.prototype.propForward=function(n){for(var t=0,l=0;l<n.length;l++)t+=n[l]*this.weights[l];this.sigmaFunction(t)},n.prototype.sigmaFunction=function(n){this.output=1/(1+Math.exp(-n))},n.prototype.sigmaDelta=function(){return this.output*(1-this.output)},n}();y.M=.3;var w=function(){function n(n,t){this.neurons=[],this.numInputs=0,this.neurons=new Array,this.numInputs=t;for(var l=0;l<n;l++)this.neurons.push(new y(t))}return n.prototype.propForward=function(n){for(var t=0;t<this.neurons.length;t++)this.neurons[t].propForward(n)},n.prototype.getOutputs=function(){for(var n=[],t=0;t<this.neurons.length;t++)n.push(this.neurons[t].output);return n},n.prototype.calcOwnError=function(n){for(var t=0;t<this.neurons.length;t++)this.neurons[t].error=n[t]*this.neurons[t].sigmaDelta()},n.prototype.errorsForSelf=function(n){for(var t=new Array,l=0;l<this.neurons.length;l++)t.push(this.neurons[l].output-n[l]);return t},n.prototype.errorsForPrevious=function(){for(var n=new Array,t=0;t<this.numInputs;t++){for(var l=0,e=0,r=this.neurons;e<r.length;e++){var u=r[e];l+=u.error*u.weights[t]}n.push(l)}return n},n.prototype.updateWeights=function(n){for(var t=0,l=this.neurons;t<l.length;t++)for(var e=l[t],r=0;r<e.weights.length;r++)e.weights[r]-=y.M*n[r]*e.error},n}(),S=function(){function n(n,t){this.layers=[],this.layers=new Array,this.layers.push(new w(t[0],n));for(var l=1;l<t.length;l++)this.layers.push(new w(t[l],t[l-1]))}return n.prototype.propForward=function(n){for(var t=n,l=0,e=this.layers;l<e.length;l++){var r=e[l];r.propForward(t),t=r.getOutputs()}return t},n.prototype.propBackward=function(n){var t=this.layers[this.layers.length-1];t.calcOwnError(t.errorsForSelf(n));for(var l=this.layers.length-2;l>=0;l--)this.layers[l].calcOwnError(this.layers[l+1].errorsForPrevious())},n.prototype.updateWeights=function(n){for(var t=this.layers.length-1;t>0;t--)this.layers[t].updateWeights(this.layers[t-1].getOutputs());this.layers[0].updateWeights(n)},n.prototype.trainSample=function(n,t){this.propForward(n),this.propBackward(t),this.updateWeights(n)},n}(),x=l("TO51"),C=function(){function n(n){this.samplesService=n,this.itersPerCycle=100,this.resultSource=new x.a,this.result$=this.resultSource.asObservable()}return n.prototype.createNet=function(){var n=this.samplesService.sensorWidth*this.samplesService.sensorHeihht,t=this.samplesService.sampleGroups.length;this.net=new S(n,[n,t]),this.trainData=this.samplesService.getTrainData(),console.log("Net created")},n.prototype.trainCycle=function(){for(var n=0;n<this.itersPerCycle;n++)for(var t=0,l=this.trainData;t<l.length;t++){var e=l[t];this.net.trainSample(e.inputs,e.outputs)}},n.prototype.calcMSE=function(){for(var n=0,t=0,l=this.trainData;t<l.length;t++){var e=l[t];this.net.propForward(e.inputs),n+=this.net.layers[this.net.layers.length-1].errorsForSelf(e.outputs).reduce(function(n,t){return n+t*t},0)}return n/this.trainData.length},n.prototype.getResult=function(){for(var n=this.net.propForward(this.samplesService.gridFromSample({points:this.samplesService.points,letter:null})),t=n[0],l=0,e=0;e<n.length;e++)n[e]>t&&(t=n[e],l=e);var r=this.samplesService.sampleGroups[l].letter;this.resultSource.next(r)},n.ctorParameters=function(){return[{type:v}]},n}(),b=function(){function n(n,t){this.samplesService=n,this.trainingService=t,this.isDrawing=!1,this.sampleGroups=[]}return n.prototype.ngOnInit=function(){var n=this;this.fitToContainer(),this.cx=this.canvasRef.nativeElement.getContext("2d"),this.trainingService.result$.subscribe(function(t){n.onClear(),n.drawChar(t),setTimeout(function(){n.onClear()},1e3)})},n.prototype.fitToContainer=function(){var n=this.canvasRef.nativeElement;n.style.width="100%",n.style.height="100%",n.width=n.offsetWidth,n.height=n.offsetHeight},n.prototype.onDown=function(){this.isDrawing=!0},n.prototype.onUp=function(){this.isDrawing=!1,this.lastPoint=null},n.prototype.onMove=function(n){if(this.isDrawing){var t=this.canvasRef.nativeElement.getBoundingClientRect();this.draw({x:n.clientX-t.left,y:n.clientY-t.top})}},n.prototype.draw=function(n){this.samplesService.points.push(n),this.cx.beginPath(),this.cx.lineWidth=10,this.cx.lineCap="round",this.lastPoint&&this.cx.moveTo(this.lastPoint.x,this.lastPoint.y),this.cx.lineTo(n.x,n.y),this.lastPoint=n,this.cx.stroke()},n.prototype.onTouchMove=function(n){var t=this.canvasRef.nativeElement.getBoundingClientRect();this.draw({x:n.touches.item(0).clientX-t.left,y:n.touches.item(0).clientY-t.top}),n.preventDefault()},n.prototype.onClear=function(){this.samplesService.points=[],this.cx.clearRect(0,0,this.canvasRef.nativeElement.width,this.canvasRef.nativeElement.height)},n.prototype.addSample=function(n){this.samplesService.addSample({letter:n,points:this.samplesService.points}),this.onClear(),this.sampleGroups=this.samplesService.sampleGroups},n.prototype.drawChar=function(n){this.cx.textBaseline="middle",this.cx.textAlign="center",this.cx.canvas.height,this.cx.font=Math.floor(.75*this.cx.canvas.height)+"px Arial",this.cx.fillText(n,this.cx.canvas.width/2,this.cx.canvas.height/2)},n.ctorParameters=function(){return[{type:v},{type:C}]},n}(),M=l("qbdv"),O=[m],P=p._5({encapsulation:0,styles:O,data:{}}),F=(p._3("app-drawing",b,u,{},{},[]),[".netConrols[_ngcontent-%COMP%]{margin-left:5%}.trainInfo[_ngcontent-%COMP%]{margin-top:1em!important;font-style:italic}.control[_ngcontent-%COMP%]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;font-weight:700}.control[_ngcontent-%COMP%]:hover{color:#607d8b}"]),k=function(){function n(n){this.trainingService=n,this.errInital=0,this.errCurrent=0,this.iterations=0,this.trainingStarted=!1}return n.prototype.ngOnInit=function(){},n.prototype.create=function(){this.trainingService.net||(this.trainingService.createNet(),this.errInital=this.trainingService.calcMSE(),this.iterations=0),this.trainingStarted=!this.trainingStarted,this.train()},n.prototype.train=function(){var n=this;this.trainingStarted&&(this.trainingService.trainCycle(),this.iterations+=this.trainingService.itersPerCycle,this.errCurrent=this.trainingService.calcMSE(),setTimeout(function(){n.train()},50))},n.prototype.check=function(){this.trainingService.getResult()},n.ctorParameters=function(){return[{type:C}]},n}(),I=[F],D=p._5({encapsulation:0,styles:I,data:{}}),E=(p._3("app-training",k,a,{},{},[]),[d]),W=p._5({encapsulation:0,styles:E,data:{}}),H=p._3("app-root",g,h,{},{},[]),R=l("fc+i"),T=l("bm2B"),A=p._4(_,[g],function(n){return p._18([p._19(512,p.i,p._0,[[8,[H]],[3,p.i],p.x]),p._19(5120,p.v,p._17,[[3,p.v]]),p._19(4608,M.f,M.e,[p.v]),p._19(4608,p.h,p.h,[]),p._19(5120,p.a,p._9,[]),p._19(5120,p.t,p._14,[]),p._19(5120,p.u,p._15,[]),p._19(4608,R.b,R.s,[M.b]),p._19(6144,p.J,null,[R.b]),p._19(4608,R.e,R.f,[]),p._19(5120,R.c,function(n,t,l,e){return[new R.k(n),new R.o(t),new R.n(l,e)]},[M.b,M.b,M.b,R.e]),p._19(4608,R.d,R.d,[R.c,p.z]),p._19(135680,R.m,R.m,[M.b]),p._19(4608,R.l,R.l,[R.d,R.m]),p._19(6144,p.H,null,[R.l]),p._19(6144,R.p,null,[R.m]),p._19(4608,p.O,p.O,[p.z]),p._19(4608,R.g,R.g,[M.b]),p._19(4608,R.i,R.i,[M.b]),p._19(4608,T.c,T.c,[]),p._19(4608,v,v,[]),p._19(4608,C,C,[v]),p._19(512,M.a,M.a,[]),p._19(1024,p.l,R.q,[]),p._19(1024,p.b,function(n,t){return[R.r(n,t)]},[[2,R.h],[2,p.y]]),p._19(512,p.c,p.c,[[2,p.b]]),p._19(131584,p._7,p._7,[p.z,p._1,p.r,p.l,p.i,p.c]),p._19(2048,p.e,null,[p._7]),p._19(512,p.d,p.d,[p.e]),p._19(512,R.a,R.a,[[3,R.a]]),p._19(512,T.b,T.b,[]),p._19(512,T.a,T.a,[]),p._19(512,_,_,[])])});f.production&&Object(p.U)(),Object(R.j)().bootstrapModuleFactory(A).catch(function(n){return console.log(n)})},gFIY:function(n,t){function l(n){return Promise.resolve().then(function(){throw new Error("Cannot find module '"+n+"'.")})}l.keys=function(){return[]},l.resolve=l,n.exports=l,l.id="gFIY"}},[0]);