webpackJsonp([1],{0:function(n,l,t){n.exports=t("cDNt")},cDNt:function(n,l,t){"use strict";function e(n){return p._24(0,[(n()(),p._8(0,0,null,null,4,"li",[],null,null,null,null,null)),(n()(),p._23(-1,null,["\n      "])),(n()(),p._8(2,0,null,null,1,"span",[["class","sample"]],null,null,null,null,null)),(n()(),p._23(3,null,["",""])),(n()(),p._23(4,null,[" [","]\n    "]))],null,function(n,l){n(l,3,0,l.context.$implicit.letter),n(l,4,0,l.context.$implicit.count)})}function r(n){return p._24(0,[p._21(402653184,1,{canvasRef:0}),(n()(),p._8(1,0,null,null,13,"div",[["class","canvasHolder"]],null,null,null,null,null)),(n()(),p._23(-1,null,["\n  "])),(n()(),p._8(3,0,null,null,7,"div",[["class","topHint"]],null,null,null,null,null)),(n()(),p._23(-1,null,["\n    "])),(n()(),p._8(5,0,null,null,1,"span",[],null,null,null,null,null)),(n()(),p._23(-1,null,["Draw any character here"])),(n()(),p._23(-1,null,["\n    "])),(n()(),p._8(8,0,null,null,1,"span",[["class","clear"]],null,[[null,"click"]],function(n,l,t){var e=!0,r=n.component;if("click"===l){e=!1!==r.onClear()&&e}return e},null,null)),(n()(),p._23(-1,null,["[ clear ]"])),(n()(),p._23(-1,null,["\n  "])),(n()(),p._23(-1,null,["\n  "])),(n()(),p._8(12,0,[[1,0],["canvas",1]],null,1,"canvas",[],null,[[null,"mousedown"],[null,"mouseup"],[null,"mousemove"],[null,"touchmove"]],function(n,l,t){var e=!0,r=n.component;if("mousedown"===l){e=!1!==r.onDown()&&e}if("mouseup"===l){e=!1!==r.onUp()&&e}if("mousemove"===l){e=!1!==r.onMove(t)&&e}if("touchmove"===l){e=!1!==r.onTouchMove(t)&&e}return e},null,null)),(n()(),p._23(-1,null,["\n  "])),(n()(),p._23(-1,null,["\n"])),(n()(),p._23(-1,null,["\n"])),(n()(),p._8(16,0,null,null,19,"div",[["class","samplesHolder"]],null,null,null,null,null)),(n()(),p._23(-1,null,["\n  "])),(n()(),p._8(18,0,null,null,1,"span",[],null,null,null,null,null)),(n()(),p._23(-1,null,["Add it to the learn list"])),(n()(),p._23(-1,null,["\n  "])),(n()(),p._8(21,0,null,null,0,"br",[],null,null,null,null,null)),(n()(),p._23(-1,null,["\n  "])),(n()(),p._8(23,0,null,null,0,"br",[],null,null,null,null,null)),(n()(),p._23(-1,null,[" \n  "])),(n()(),p._8(25,0,[["letter",1]],null,0,"input",[],null,null,null,null,null)),(n()(),p._23(-1,null,["\n  "])),(n()(),p._8(27,0,null,null,1,"button",[],null,[[null,"click"]],function(n,l,t){var e=!0,r=n.component;if("click"===l){r.addSample(p._20(n,25).value);e=!1!==(p._20(n,25).value="")&&e}return e},null,null)),(n()(),p._23(-1,null,["Add"])),(n()(),p._23(-1,null,["\n  "])),(n()(),p._8(30,0,null,null,4,"ul",[["class","samples"]],null,null,null,null,null)),(n()(),p._23(-1,null,["\n    "])),(n()(),p._2(16777216,null,null,1,null,e)),p._6(33,802816,null,0,M.c,[p.Q,p.N,p.t],{ngForOf:[0,"ngForOf"]},null),(n()(),p._23(-1,null,["\n  "])),(n()(),p._23(-1,null,["\n"])),(n()(),p._23(-1,null,["\n"])),(n()(),p._8(37,0,null,null,0,"div",[["class","separator"]],null,null,null,null,null)),(n()(),p._23(-1,null,["\n"]))],function(n,l){n(l,33,0,l.component.sampleGroups)},null)}function u(n){return p._24(0,[(n()(),p._8(0,0,null,null,1,"app-drawing",[],null,null,null,r,P)),p._6(1,114688,null,0,b,[m,x],null,null)],function(n,l){n(l,1,0)},null)}function i(n){return p._24(0,[(n()(),p._8(0,0,null,null,1,"span",[["class","control"]],null,[[null,"click"]],function(n,l,t){var e=!0,r=n.component;if("click"===l){e=!1!==r.create()&&e}return e},null,null)),(n()(),p._23(-1,null,["\n\t  [ train ]\n\t"]))],null,null)}function o(n){return p._24(0,[(n()(),p._8(0,0,null,null,1,"span",[["class","control"]],null,[[null,"click"]],function(n,l,t){var e=!0,r=n.component;if("click"===l){e=!1!==r.create()&&e}return e},null,null)),(n()(),p._23(-1,null,["\n\t  [ stop ]\n\t"]))],null,null)}function s(n){return p._24(0,[(n()(),p._8(0,0,null,null,23,"div",[["class","netConrols"]],null,null,null,null,null)),(n()(),p._23(-1,null,["\n\t"])),(n()(),p._2(16777216,null,null,1,null,i)),p._6(3,16384,null,0,M.d,[p.Q,p.N],{ngIf:[0,"ngIf"]},null),(n()(),p._23(-1,null,["\n\t"])),(n()(),p._2(16777216,null,null,1,null,o)),p._6(6,16384,null,0,M.d,[p.Q,p.N],{ngIf:[0,"ngIf"]},null),(n()(),p._23(-1,null,["\n\t\t\xa0\xa0\xa0\n    "])),(n()(),p._8(8,0,null,null,1,"span",[["class","control"]],null,[[null,"click"]],function(n,l,t){var e=!0,r=n.component;if("click"===l){e=!1!==r.check()&&e}return e},null,null)),(n()(),p._23(-1,null,["\n\t  [ check ]\n\t"])),(n()(),p._23(-1,null,["\n\n\t"])),(n()(),p._8(11,0,null,null,0,"br",[],null,null,null,null,null)),(n()(),p._23(-1,null,["\n    "])),(n()(),p._8(13,0,null,null,0,"br",[],null,null,null,null,null)),(n()(),p._23(-1,null,["\n\t"])),(n()(),p._8(15,0,null,null,1,"div",[],null,null,null,null,null)),(n()(),p._23(16,null,["MSE Initial: ",""])),(n()(),p._23(-1,null,["\n\t"])),(n()(),p._8(18,0,null,null,1,"div",[],null,null,null,null,null)),(n()(),p._23(19,null,["MSE Current: ",""])),(n()(),p._23(-1,null,["\n\t"])),(n()(),p._8(21,0,null,null,1,"div",[],null,null,null,null,null)),(n()(),p._23(22,null,["Iterations: ",""])),(n()(),p._23(-1,null,["\n\t\n"])),(n()(),p._23(-1,null,["\n\n"]))],function(n,l){var t=l.component;n(l,3,0,!t.trainingStarted),n(l,6,0,t.trainingStarted)},function(n,l){var t=l.component;n(l,16,0,t.errInital),n(l,19,0,t.errCurrent),n(l,22,0,t.iterations)})}function a(n){return p._24(0,[(n()(),p._8(0,0,null,null,1,"app-training",[],null,null,null,s,D)),p._6(1,114688,null,0,k,[x],null,null)],function(n,l){n(l,1,0)},null)}function c(n){return p._24(0,[(n()(),p._23(-1,null,["\n"])),(n()(),p._8(1,0,null,null,4,"div",[["style","text-align:center"]],null,null,null,null,null)),(n()(),p._23(-1,null,["\n  "])),(n()(),p._8(3,0,null,null,1,"h1",[],null,null,null,null,null)),(n()(),p._23(-1,null,["\n    Neural Hand Writing Recognizer \n  "])),(n()(),p._23(-1,null,["\n"])),(n()(),p._23(-1,null,["\n"])),(n()(),p._8(7,0,null,null,1,"app-drawing",[],null,null,null,r,P)),p._6(8,114688,null,0,b,[m,x],null,null),(n()(),p._23(-1,null,["\n"])),(n()(),p._8(10,0,null,null,1,"app-training",[],null,null,null,s,D)),p._6(11,114688,null,0,k,[x],null,null),(n()(),p._23(-1,null,["\n"]))],function(n,l){n(l,8,0),n(l,11,0)},null)}function h(n){return p._24(0,[(n()(),p._8(0,0,null,null,1,"app-root",[],null,null,null,c,H)),p._6(1,49152,null,0,g,[],null,null)],null,null)}Object.defineProperty(l,"__esModule",{value:!0});var p=t("/oeL"),f={production:!0},_=function(){function n(){}return n}(),g=function(){function n(){}return n}(),d=[""],v=[".canvasHolder[_ngcontent-%COMP%]{width:40%;height:18em;margin-left:5%;margin-right:2%;float:left}.canvasHolder[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{width:100%;height:100%;background-color:#d3d3d3;cursor:crosshair;border-radius:4px;border:1px solid #000}.samplesHolder[_ngcontent-%COMP%]{width:40%;margin-left:2%;margin-right:5%;height:50%;float:left}.clear[_ngcontent-%COMP%]{cursor:pointer;font-weight:700;float:right}.clear[_ngcontent-%COMP%]:hover{color:#607d8b}.samples[_ngcontent-%COMP%]{margin:0 0 2em 0;list-style-type:none;padding:0;width:15em}.samples[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{cursor:pointer;position:relative;left:0;background-color:#eee;margin:.2em;padding:.2em 0;border-radius:4px}.samples[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{color:#607d8b;background-color:#ddd}.samples[_ngcontent-%COMP%]   .sample[_ngcontent-%COMP%]{padding-left:2em;font-weight:700}input[_ngcontent-%COMP%]{margin:.4em;width:8.5em}button[_ngcontent-%COMP%], input[_ngcontent-%COMP%]{font-size:120%}"],m=function(){function n(){this.points=[],this.samples=[],this.sampleGroups=[],this.letterIndex=[],this.sensorWidth=6,this.sensorHeihht=8}return n.prototype.addSample=function(n){if(console.log("add sample 1"),console.log(this.letterIndex[n.letter]),void 0===this.letterIndex[n.letter]){var l={letter:n.letter,count:0};this.letterIndex[n.letter]=l,this.sampleGroups.push(l),console.log(this.sampleGroups),n.points.length>0&&(l.count++,this.samples.push(n))}else n.points.length>0&&(this.letterIndex[n.letter].count++,this.samples.push(n))},n.prototype.outputFromSample=function(n){for(var l=[],t=0;t<this.sampleGroups.length;t++)this.sampleGroups[t].letter===n.letter?l.push(1):l.push(0);return l},n.prototype.gridFromSample=function(n){for(var l=-1/0,t=-1/0,e=1/0,r=1/0,u=0,i=n.points;u<i.length;u++){var o=i[u];o.x>l&&(l=o.x),o.x<e&&(e=o.x),o.y>t&&(t=o.y),o.y<r&&(r=o.y)}console.log(e+" "+r+" "+l+" "+t);var s=new Array(this.sensorWidth*this.sensorHeihht);s.fill(0);for(var a=0,c=n.points;a<c.length;a++){var o=c[a],h=this.sensorWidth*(o.x-e)/(l-e+1),p=this.sensorHeihht*(o.y-r)/(t-r+1);s[Math.floor(h)+this.sensorWidth*Math.floor(p)]=1,console.log(Math.floor(h)+" "+Math.floor(p))}for(var f="",_=0;_<s.length;_++)_%this.sensorWidth==0&&(f+="\n"),f+=s[_];return console.log(f),s},n.prototype.getTrainData=function(){for(var n=[],l=0,t=this.samples;l<t.length;l++){var e=t[l];n.push({inputs:this.gridFromSample(e),outputs:this.outputFromSample(e)})}return n},n.ctorParameters=function(){return[]},n}(),y=function(){function n(n){this.error=0,this.weights=new Array,this.deltas=new Array;for(var l=0;l<n;l++)this.weights.push(.1*Math.random()),this.deltas.push(0)}return n.prototype.propForward=function(n){for(var l=0,t=0;t<n.length;t++)l+=n[t]*this.weights[t];this.sigmaFunction(l)},n.prototype.sigmaFunction=function(n){this.output=1/(1+Math.exp(-n))},n.prototype.sigmaDelta=function(){return this.output*(1-this.output)},n}();y.M=.3;var w=function(){function n(n,l){this.neurons=[],this.numInputs=0,this.neurons=new Array,this.numInputs=l;for(var t=0;t<n;t++)this.neurons.push(new y(l))}return n.prototype.propForward=function(n){for(var l=0;l<this.neurons.length;l++)this.neurons[l].propForward(n)},n.prototype.getOutputs=function(){for(var n=[],l=0;l<this.neurons.length;l++)n.push(this.neurons[l].output);return n},n.prototype.calcOwnError=function(n){for(var l=0;l<this.neurons.length;l++)this.neurons[l].error=n[l]*this.neurons[l].sigmaDelta()},n.prototype.errorsForSelf=function(n){for(var l=new Array,t=0;t<this.neurons.length;t++)l.push(this.neurons[t].output-n[t]);return l},n.prototype.errorsForPrevious=function(){for(var n=new Array,l=0;l<this.numInputs;l++){for(var t=0,e=0,r=this.neurons;e<r.length;e++){var u=r[e];t+=u.error*u.weights[l]}n.push(t)}return n},n.prototype.updateWeights=function(n){for(var l=0,t=this.neurons;l<t.length;l++)for(var e=t[l],r=0;r<e.weights.length;r++)e.weights[r]-=y.M*n[r]*e.error},n}(),S=function(){function n(n,l){this.layers=[],this.layers=new Array,this.layers.push(new w(l[0],n));for(var t=1;t<l.length;t++)this.layers.push(new w(l[t],l[t-1]))}return n.prototype.propForward=function(n){for(var l=n,t=0,e=this.layers;t<e.length;t++){var r=e[t];r.propForward(l),l=r.getOutputs()}return l},n.prototype.propBackward=function(n){var l=this.layers[this.layers.length-1];l.calcOwnError(l.errorsForSelf(n));for(var t=this.layers.length-2;t>=0;t--)this.layers[t].calcOwnError(this.layers[t+1].errorsForPrevious())},n.prototype.updateWeights=function(n){for(var l=this.layers.length-1;l>0;l--)this.layers[l].updateWeights(this.layers[l-1].getOutputs());this.layers[0].updateWeights(n)},n.prototype.trainSample=function(n,l){this.propForward(n),this.propBackward(l),this.updateWeights(n)},n}(),C=t("TO51"),x=function(){function n(n){this.samplesService=n,this.itersPerCycle=100,this.resultSource=new C.a,this.result$=this.resultSource.asObservable()}return n.prototype.createNet=function(){var n=this.samplesService.sensorWidth*this.samplesService.sensorHeihht,l=this.samplesService.sampleGroups.length;this.net=new S(n,[n,l]),this.trainData=this.samplesService.getTrainData(),console.log("Net created")},n.prototype.trainCycle=function(){for(var n=0;n<this.itersPerCycle;n++)for(var l=0,t=this.trainData;l<t.length;l++){var e=t[l];this.net.trainSample(e.inputs,e.outputs)}},n.prototype.calcMSE=function(){for(var n=0,l=0,t=this.trainData;l<t.length;l++){var e=t[l];this.net.propForward(e.inputs),n+=this.net.layers[this.net.layers.length-1].errorsForSelf(e.outputs).reduce(function(n,l){return n+l*l},0)}return n/this.trainData.length},n.prototype.getResult=function(){for(var n=this.net.propForward(this.samplesService.gridFromSample({points:this.samplesService.points,letter:null})),l=n[0],t=0,e=0;e<n.length;e++)n[e]>l&&(l=n[e],t=e);var r=this.samplesService.sampleGroups[t].letter;this.resultSource.next(r)},n.ctorParameters=function(){return[{type:m}]},n}(),b=function(){function n(n,l){this.samplesService=n,this.trainingService=l,this.isDrawing=!1,this.sampleGroups=[]}return n.prototype.ngOnInit=function(){var n=this;this.fitToContainer(this.canvasRef.nativeElement),this.cx=this.canvasRef.nativeElement.getContext("2d"),this.trainingService.result$.subscribe(function(l){n.onClear(),n.drawChar(l),setTimeout(function(){n.onClear()},1e3)})},n.prototype.fitToContainer=function(n){n.style.width="100%",n.style.height="100%",n.width=n.offsetWidth,n.height=n.offsetHeight},n.prototype.onDown=function(){this.isDrawing=!0},n.prototype.onUp=function(){this.isDrawing=!1},n.prototype.onMove=function(n){if(this.isDrawing){var l=this.canvasRef.nativeElement.getBoundingClientRect();this.draw({x:n.clientX-l.left,y:n.clientY-l.top})}},n.prototype.draw=function(n){this.samplesService.points.push(n),this.cx.beginPath(),this.cx.arc(n.x,n.y,3,0,2*Math.PI,!1),this.cx.fillStyle="black",this.cx.fill()},n.prototype.onTouchMove=function(n){var l=this.canvasRef.nativeElement.getBoundingClientRect();this.draw({x:n.touches.item(0).clientX-l.left,y:n.touches.item(0).clientY-l.top})},n.prototype.onClear=function(){this.samplesService.points=[],this.cx.clearRect(0,0,this.canvasRef.nativeElement.width,this.canvasRef.nativeElement.height)},n.prototype.addSample=function(n){this.samplesService.addSample({letter:n,points:this.samplesService.points}),this.onClear(),this.sampleGroups=this.samplesService.sampleGroups},n.prototype.drawChar=function(n){this.cx.textBaseline="middle",this.cx.textAlign="center",this.cx.canvas.height,this.cx.font=Math.floor(this.cx.canvas.height/2)+"px Arial",this.cx.fillText(n,this.cx.canvas.width/2,this.cx.canvas.height/2)},n.ctorParameters=function(){return[{type:m},{type:x}]},n}(),M=t("qbdv"),O=[v],P=p._5({encapsulation:0,styles:O,data:{}}),F=(p._3("app-drawing",b,u,{},{},[]),[".netConrols[_ngcontent-%COMP%]{margin-top:3.4em;margin-left:5%}.control[_ngcontent-%COMP%]{cursor:pointer;font-weight:700}.control[_ngcontent-%COMP%]:hover{color:#607d8b}.result[_ngcontent-%COMP%]{color:#000;font-weight:700;font-size:250%}"]),k=function(){function n(n){this.trainingService=n,this.errInital=0,this.errCurrent=0,this.iterations=0,this.trainingStarted=!1}return n.prototype.ngOnInit=function(){},n.prototype.create=function(){this.trainingService.net||(this.trainingService.createNet(),this.errInital=this.trainingService.calcMSE(),this.iterations=0),this.trainingStarted=!this.trainingStarted,this.train()},n.prototype.train=function(){var n=this;this.trainingStarted&&(this.trainingService.trainCycle(),this.iterations+=this.trainingService.itersPerCycle,this.errCurrent=this.trainingService.calcMSE(),setTimeout(function(){n.train()},50))},n.prototype.check=function(){this.trainingService.getResult()},n.ctorParameters=function(){return[{type:x}]},n}(),I=[F],D=p._5({encapsulation:0,styles:I,data:{}}),E=(p._3("app-training",k,a,{},{},[]),[d]),H=p._5({encapsulation:0,styles:E,data:{}}),R=p._3("app-root",g,h,{},{},[]),W=t("fc+i"),A=t("bm2B"),G=p._4(_,[g],function(n){return p._18([p._19(512,p.i,p._0,[[8,[R]],[3,p.i],p.x]),p._19(5120,p.v,p._17,[[3,p.v]]),p._19(4608,M.f,M.e,[p.v]),p._19(4608,p.h,p.h,[]),p._19(5120,p.a,p._9,[]),p._19(5120,p.t,p._14,[]),p._19(5120,p.u,p._15,[]),p._19(4608,W.b,W.s,[M.b]),p._19(6144,p.J,null,[W.b]),p._19(4608,W.e,W.f,[]),p._19(5120,W.c,function(n,l,t,e){return[new W.k(n),new W.o(l),new W.n(t,e)]},[M.b,M.b,M.b,W.e]),p._19(4608,W.d,W.d,[W.c,p.z]),p._19(135680,W.m,W.m,[M.b]),p._19(4608,W.l,W.l,[W.d,W.m]),p._19(6144,p.H,null,[W.l]),p._19(6144,W.p,null,[W.m]),p._19(4608,p.O,p.O,[p.z]),p._19(4608,W.g,W.g,[M.b]),p._19(4608,W.i,W.i,[M.b]),p._19(4608,A.c,A.c,[]),p._19(4608,m,m,[]),p._19(4608,x,x,[m]),p._19(512,M.a,M.a,[]),p._19(1024,p.l,W.q,[]),p._19(1024,p.b,function(n,l){return[W.r(n,l)]},[[2,W.h],[2,p.y]]),p._19(512,p.c,p.c,[[2,p.b]]),p._19(131584,p._7,p._7,[p.z,p._1,p.r,p.l,p.i,p.c]),p._19(2048,p.e,null,[p._7]),p._19(512,p.d,p.d,[p.e]),p._19(512,W.a,W.a,[[3,W.a]]),p._19(512,A.b,A.b,[]),p._19(512,A.a,A.a,[]),p._19(512,_,_,[])])});f.production&&Object(p.U)(),Object(W.j)().bootstrapModuleFactory(G).catch(function(n){return console.log(n)})},gFIY:function(n,l){function t(n){return Promise.resolve().then(function(){throw new Error("Cannot find module '"+n+"'.")})}t.keys=function(){return[]},t.resolve=t,n.exports=t,t.id="gFIY"}},[0]);